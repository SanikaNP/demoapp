toggleBold() {
    const focusedCell = this.gridApi.getFocusedCell();
    if (focusedCell) {
        const rowNode = focusedCell.rowNode;
        const column = focusedCell.column;

        // Update the data in the grid
        const cellData = rowNode.data[column.getColId()];
        rowNode.setDataValue(column.getColId(), cellData); // Trigger cell update

        // Update the styling for the focused cell
        const cellElement = this.gridApi.getCellRendererInstances({
            rowNodes: [rowNode],
            columns: [column]
        })[0];

        if (cellElement) {
            // Apply bold styling
            const currentWeight = cellElement.getGui().style.fontWeight;
            cellElement.getGui().style.fontWeight = currentWeight === 'bold' ? 'normal' : 'bold';
            this.gridApi.refreshCells({ force: true });
        }
    }
}

toggleItalic() {
    const focusedCell = this.gridApi.getFocusedCell();
    if (focusedCell) {
        const rowNode = focusedCell.rowNode;
        const column = focusedCell.column;

        // Update the data in the grid
        const cellData = rowNode.data[column.getColId()];
        rowNode.setDataValue(column.getColId(), cellData); // Trigger cell update

        // Update the styling for the focused cell
        const cellElement = this.gridApi.getCellRendererInstances({
            rowNodes: [rowNode],
            columns: [column]
        })[0];

        if (cellElement) {
            // Apply italic styling
            const currentStyle = cellElement.getGui().style.fontStyle;
            cellElement.getGui().style.fontStyle = currentStyle === 'italic' ? 'normal' : 'italic';
            this.gridApi.refreshCells({ force: true });
        }
    }
}

toggleUnderline() {
    const focusedCell = this.gridApi.getFocusedCell();
    if (focusedCell) {
        const rowNode = focusedCell.rowNode;
        const column = focusedCell.column;

        // Update the data in the grid
        const cellData = rowNode.data[column.getColId()];
        rowNode.setDataValue(column.getColId(), cellData); // Trigger cell update

        // Update the styling for the focused cell
        const cellElement = this.gridApi.getCellRendererInstances({
            rowNodes: [rowNode],
            columns: [column]
        })[0];

        if (cellElement) {
            // Apply underline styling
            const currentDecoration = cellElement.getGui().style.textDecoration;
            cellElement.getGui().style.textDecoration = currentDecoration === 'underline' ? 'none' : 'underline';
            this.gridApi.refreshCells({ force: true });
        }
    }
}
