toggleBold() {
    if (this.selectedCell) {
      const cellElement = this.getCellElement(this.selectedCell);
      const isBold = cellElement.style.fontWeight === 'bold';
      cellElement.style.fontWeight = isBold ? 'normal' : 'bold';
    }
  }

  toggleItalic() {
    if (this.selectedCell) {
      const cellElement = this.getCellElement(this.selectedCell);
      const isItalic = cellElement.style.fontStyle === 'italic';
      cellElement.style.fontStyle = isItalic ? 'normal' : 'italic';
    }
  }

  toggleUnderline() {
    if (this.selectedCell) {
      const cellElement = this.getCellElement(this.selectedCell);
      const isUnderlined = cellElement.style.textDecoration === 'underline';
      cellElement.style.textDecoration = isUnderlined ? 'none' : 'underline';
    }
  }

  private getCellElement(selectedCell: any): HTMLElement {
    return document.querySelector(
      `.ag-row[row-index="${selectedCell.rowIndex}"] .ag-cell[col-id="${selectedCell.column.colId}"]`
    );
  }
}
